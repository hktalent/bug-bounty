# CVE-2021-25646 Apache Druid RCE

Apache Druid includes the ability to execute user-provided JavaScript code embedded in various types of requests. This functionality is intended for use in high-trust environments, and is disabled by default. However, in Druid 0.20.0 and earlier, it is possible for an authenticated user to send a specially-crafted request that forces Druid to run user-provided JavaScript code for that request, regardless of server configuration. This can be leveraged to execute code on the target machine with the privileges of the Druid server process.

**[FOFA](https://fofa.so/result?q=title%3D%22Apache%22+%26%26+title%3D%22Druid%22&qbase64=dGl0bGU9IkFwYWNoZSIgJiYgdGl0bGU9IkRydWlkIg%3D%3D&file=&file=) query rule**: title="Apache" && title="Druid"

# Demo

![](CVE-2021-25646.gif)
